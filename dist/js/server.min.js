const express=require("express"),app=express(),mysql=require("mysql"),bodyParser=require("body-parser");app.use(bodyParser.json({type:"application/json"})),app.use(bodyParser.urlencoded({extended:!0}));const con=mysql.createConnection({host:"localhost",port:"3306",user:"tarantintoes_admin",password:"quentin",database:"tarantintoes"}),port=5e3;app.listen(5e3,()=>console.log("Server started on 5000")),con.connect(function(e){e?console.log(e):console.log("Database connected")}),app.get("/shot",(e,o)=>{con.query("SELECT movies.title, movies.rel_date, shots.shot_path, shots.timestamp FROM movies, shots WHERE movies.id = shots.movie_id ORDER BY RAND ( ) LIMIT 1",function(e,s,t){if(e)throw e;console.log(s),o.send(s)})}),app.get("/grid",(e,o)=>{con.query("SELECT movies.title, movies.rel_date, movies.poster_path, movies.rating, movies.id FROM movies ORDER BY id ASC",function(e,s,t){if(e)throw e;console.log(s),o.send(s)})}),app.get("/:id",(e,o)=>{let s=e.params.id;if(!s)return o.status(400).send({error:!0,message:"Please provide movie_id"});con.query("SELECT movies.title, movies.rel_date, movies.rating, movies.poster_path, shots.shot_path, shots.timestamp FROM movies, shots WHERE movies.id = shots.movie_id AND shots.movie_id = ?",s,function(e,s,t){if(e)throw e;console.log(s),o.send(s)})});